## ShiroJwt

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](https://github.com/wang926454/ShiroJwt/pulls)
[![GitHub stars](https://img.shields.io/github/stars/wang926454/ShiroJwt.svg?style=social&label=Stars)](https://github.com/wang926454/ShiroJwt)
[![GitHub forks](https://img.shields.io/github/forks/wang926454/ShiroJwt.svg?style=social&label=Fork)](https://github.com/wang926454/ShiroJwt)

> å‰ç«¯åœ°å€:[https://github.com/wang926454/VueStudy/tree/master/VueStudy08-JWT](http://u.720life.cn/g/54145d0471d91890860f7f8463c030460e90c88943464bfada129ab1cbf0a3d37843f8308fc52da1031e5daea556cc7004bf429f27332ac4fa59abcc162305c2211f617a67fd15ea49d84c90591a2adf) 

#### Issues

1. [#14 é‡å¤è¯·æ±‚ä¼šä¸ä¼šç”Ÿæˆå¤šä¸ªtoken](http://u.720life.cn/g/54145d0471d91890860f7f8463c03046c4b65af76e7b5113a7ad36a4df094294af292f78f45ba2f8499a85c544debd80) 
2. [#19 è·¨åŸŸssoé—®é¢˜](http://u.720life.cn/g/54145d0471d91890860f7f8463c03046c4b65af76e7b5113a7ad36a4df0942943dcf93cd0e4b646b6364459f268ff670) 
3. [#22 å¦‚æœæ˜¯å¾®æœåŠ¡çš„è¯ï¼Œæ˜¯ä¸æ˜¯æ¯ä¸ªå¾®æœåŠ¡éƒ½çš„å†™ä¸€å¥—è¿™æ ·çš„shiro?](http://u.720life.cn/g/54145d0471d91890860f7f8463c03046c4b65af76e7b5113a7ad36a4df094294c7f6da2bf33bd19e4931c1451b603d7a) 

#### é¡¹ç›®ç›¸å…³

* JavaDoc:[https://apidoc.gitee.com/dolyw/ShiroJwt](http://u.720life.cn/g/b6749edd47dfb34db84492b28bcc9586c6740badc43fdeb3bb3c8bdbdec8dfb101fbb255fda77a5058945f1c478f968b) 
* æ¥å£æ–‡æ¡£:[https://github.com/wang926454/MyDocs/blob/master/Project/ShiroJwt/ShiroJwt-Interface.md](http://u.720life.cn/g/54145d0471d91890860f7f8463c030462682c05c83cb6b8eae8ce4a9fa45824eaa34d4bac8839e747254f694c917c6c6b08d4afc5ae61736f816200163fce03fc45884e3e1768ef8b0f04168f6889cc2508634a9a0affe26e2b7f300c5154b90) 
* æ•™ç¨‹ç›®å½•:[https://github.com/wang926454/MyDocs/blob/master/Project/ShiroJwt/ShiroJwt01.md](http://u.720life.cn/g/54145d0471d91890860f7f8463c030462682c05c83cb6b8eae8ce4a9fa45824eaa34d4bac8839e747254f694c917c6c6b08d4afc5ae61736f816200163fce03f339bfb56abf9cc3544cec76cf1e467fb) 
* æ”¹ä¸ºæ•°æ®åº“å½¢å¼(MySQL):[https://github.com/wang926454/MyDocs/blob/master/Project/ShiroJwt/ShiroJwt02-MySQL.md](http://u.720life.cn/g/54145d0471d91890860f7f8463c030462682c05c83cb6b8eae8ce4a9fa45824eaa34d4bac8839e747254f694c917c6c6b08d4afc5ae61736f816200163fce03f643cd93eadcbf2266bd12a13a823073152a8c5251543cf7d5a8914731bd4e2eb) 
* è§£å†³æ— æ³•ç›´æ¥è¿”å›401é”™è¯¯:[https://github.com/wang926454/MyDocs/blob/master/Project/ShiroJwt/ShiroJwt03-401.md](http://u.720life.cn/g/54145d0471d91890860f7f8463c030462682c05c83cb6b8eae8ce4a9fa45824eaa34d4bac8839e747254f694c917c6c6b08d4afc5ae61736f816200163fce03fbc0922981b100c352a625598bfb09adb277e5e297faef78d7811fc1a46977d02) 
* å®ç°Shiroçš„Cache(Redis)åŠŸèƒ½:[https://github.com/wang926454/MyDocs/blob/master/Project/ShiroJwt/ShiroJwt04-Redis.md](http://u.720life.cn/g/54145d0471d91890860f7f8463c030462682c05c83cb6b8eae8ce4a9fa45824eaa34d4bac8839e747254f694c917c6c6b08d4afc5ae61736f816200163fce03f56ba6eb6a459a02403fcc7a45bcbbd1dc418dcedb72bbccef550aad0d7c34bfb) 

#### é¡¹ç›®ä»‹ç»

1. RESTful API
2. Mavené›†æˆMybatis Generator(é€†å‘å·¥ç¨‹)
3. Shiro + Java-JWTå®ç°æ— çŠ¶æ€é‰´æƒæœºåˆ¶(Token)
4. å¯†ç åŠ å¯†(é‡‡ç”¨AES-128 + Base64çš„æ–¹å¼)
5. é›†æˆRedis(Jedis)
6. é‡å†™Shiroç¼“å­˜æœºåˆ¶(Redis)
7. Redisä¸­ä¿å­˜RefreshTokenä¿¡æ¯(åšåˆ°JWTçš„å¯æ§æ€§)
8. æ ¹æ®RefreshTokenè‡ªåŠ¨åˆ·æ–°AccessToken

##### å…³äºShiro + Java-JWTå®ç°æ— çŠ¶æ€é‰´æƒæœºåˆ¶(Token)
```txt
é¦–å…ˆPostç”¨æˆ·åä¸å¯†ç åˆ°user/loginè¿›è¡Œç™»å…¥ï¼Œå¦‚æœæˆåŠŸè¿”å›ä¸€ä¸ªåŠ å¯†çš„AccessTokenï¼Œå¤±è´¥çš„è¯ç›´æ¥è¿”å›401é”™è¯¯(å¸å·æˆ–å¯†ç ä¸æ­£ç¡®)ï¼Œä»¥
åè®¿é—®éƒ½å¸¦ä¸Šè¿™ä¸ªAccessTokenå³å¯ï¼Œé‰´æƒæµç¨‹ä¸»è¦æ˜¯é‡å†™äº†Shiroçš„å…¥å£è¿‡æ»¤å™¨JWTFilter(BasicHttpAuthenticationFilter)ï¼Œåˆ¤æ–­è¯·æ±‚
Headeré‡Œé¢æ˜¯å¦åŒ…å«Authorizationå­—æ®µï¼Œæœ‰å°±è¿›è¡ŒShiroçš„Tokenç™»å½•è®¤è¯æˆæƒ(ç”¨æˆ·è®¿é—®æ¯ä¸€ä¸ªéœ€è¦æƒé™çš„è¯·æ±‚å¿…é¡»åœ¨Headerä¸­æ·»åŠ Author
izationå­—æ®µå­˜æ”¾AccessToken)ï¼Œæ²¡æœ‰å°±ä»¥æ¸¸å®¢ç›´æ¥è®¿é—®(æœ‰æƒé™ç®¡æ§çš„è¯ï¼Œä»¥æ¸¸å®¢è®¿é—®å°±ä¼šè¢«æ‹¦æˆª)
```

##### å…³äºAES-128 + Base64å½“ä¸¤ä¸ªç”¨æˆ·çš„æ˜æ–‡å¯†ç ç›¸åŒæ—¶è¿›è¡ŒåŠ å¯†ï¼Œä¼šå‘ç°æ•°æ®åº“ä¸­å­˜åœ¨ç›¸åŒç»“æ„çš„æš—æ–‡å¯†ç 
```txt
å¤§éƒ¨åˆ†æ˜¯ä»¥MD5 + ç›çš„å½¢å¼è§£å†³äº†è¿™ä¸ªé—®é¢˜(è¯¦ç»†è‡ªå·±ç™¾åº¦)ï¼Œæˆ‘é‡‡ç”¨AES-128 + Base64æ˜¯ä»¥å¸å·+å¯†ç çš„å½¢å¼è¿›è¡ŒåŠ å¯†å¯†ç ï¼Œå› ä¸ºå¸å·å…·
æœ‰å”¯ä¸€æ€§ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šå‡ºç°ç›¸åŒç»“æ„çš„æš—æ–‡å¯†ç è¿™ä¸ªé—®é¢˜
```

##### å…³äºå°†Jediså·¥å…·ç±»ä¸SpringBootæ•´åˆ
```txt
æœ¬æ¥æ˜¯ç›´æ¥å°†JedisUtilæ³¨å…¥ä¸ºBeanï¼Œæ¯æ¬¡ä½¿ç”¨ç›´æ¥@Autowiredæ³¨å…¥ä½¿ç”¨å³å¯ï¼Œä½†æ˜¯åœ¨é‡å†™Shiroçš„CustomCacheæ— æ³•æ³¨å…¥JedisUtilï¼Œæ‰€ä»¥
å°±æ”¹æˆé™æ€æ³¨å…¥JedisPoolè¿æ¥æ± ï¼ŒJedisUtilå·¥å…·ç±»è¿˜æ˜¯ç›´æ¥è°ƒç”¨é™æ€æ–¹æ³•ï¼Œæ— éœ€@Autowiredæ³¨å…¥
```

##### å…³äºRedisä¸­ä¿å­˜RefreshTokenä¿¡æ¯(åšåˆ°JWTçš„å¯æ§æ€§)
```txt
ç™»å½•è®¤è¯é€šè¿‡åè¿”å›AccessTokenä¿¡æ¯(åœ¨AccessTokenä¸­ä¿å­˜å½“å‰çš„æ—¶é—´æˆ³å’Œå¸å·)ï¼ŒåŒæ—¶åœ¨Redisä¸­è®¾ç½®ä¸€æ¡ä»¥å¸å·ä¸ºKeyï¼ŒValueä¸ºå½“å‰æ—¶
é—´æˆ³(ç™»å½•æ—¶é—´)çš„RefreshTokenï¼Œç°åœ¨è®¤è¯æ—¶å¿…é¡»AccessTokenæ²¡å¤±æ•ˆä»¥åŠRediså­˜åœ¨æ‰€å¯¹åº”çš„RefreshTokenï¼Œä¸”RefreshTokenæ—¶é—´æˆ³å’ŒAc
cessTokenä¿¡æ¯ä¸­æ—¶é—´æˆ³ä¸€è‡´æ‰ç®—è®¤è¯é€šè¿‡ï¼Œè¿™æ ·å¯ä»¥åšåˆ°JWTçš„å¯æ§æ€§ï¼Œå¦‚æœé‡æ–°ç™»å½•è·å–äº†æ–°çš„AccessTokenï¼Œæ—§çš„AccessTokenå°±è®¤è¯ä¸
äº†ï¼Œå› ä¸ºRedisä¸­æ‰€å­˜æ”¾çš„çš„RefreshTokenæ—¶é—´æˆ³ä¿¡æ¯åªä¼šå’Œæœ€æ–°çš„AccessTokenä¿¡æ¯ä¸­æºå¸¦çš„æ—¶é—´æˆ³ä¸€è‡´ï¼Œè¿™æ ·æ¯ä¸ªç”¨æˆ·å°±åªèƒ½ä½¿ç”¨æœ€æ–°çš„
AccessTokenè®¤è¯ï¼ŒRedisçš„RefreshTokenä¹Ÿå¯ä»¥ç”¨æ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦åœ¨çº¿ï¼Œå¦‚æœåˆ é™¤Redisçš„æŸä¸ªRefreshTokenï¼Œé‚£è¿™ä¸ªRefreshTokenæ‰€å¯¹
åº”çš„AccessTokenä¹‹åä¹Ÿæ— æ³•é€šè¿‡è®¤è¯äº†ï¼Œå°±ç›¸å½“äºæ§åˆ¶äº†ç”¨æˆ·çš„ç™»å½•ï¼Œå¯ä»¥å‰”é™¤ç”¨æˆ·
```

##### å…³äºæ ¹æ®RefreshTokenè‡ªåŠ¨åˆ·æ–°AccessToken
```txt
æœ¬èº«AccessTokençš„è¿‡æœŸæ—¶é—´ä¸º5åˆ†é’Ÿ(é…ç½®æ–‡ä»¶å¯é…ç½®)ï¼ŒRefreshTokenè¿‡æœŸæ—¶é—´ä¸º30åˆ†é’Ÿ(é…ç½®æ–‡ä»¶å¯é…ç½®)ï¼Œå½“ç™»å½•åæ—¶é—´è¿‡äº†5åˆ†é’Ÿä¹‹å
ï¼Œå½“å‰AccessTokenä¾¿ä¼šè¿‡æœŸå¤±æ•ˆï¼Œå†æ¬¡å¸¦ä¸ŠAccessTokenè®¿é—®JWTä¼šæŠ›å‡ºTokenExpiredExceptionå¼‚å¸¸è¯´æ˜Tokenè¿‡æœŸï¼Œå¼€å§‹åˆ¤æ–­æ˜¯å¦è¦è¿›
è¡ŒAccessTokenåˆ·æ–°ï¼Œé¦–å…ˆRedisæŸ¥è¯¢RefreshTokenæ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠæ—¶é—´æˆ³å’Œè¿‡æœŸAccessTokenæ‰€æºå¸¦çš„æ—¶é—´æˆ³æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœå­˜åœ¨ä¸”ä¸€è‡´å°±
è¿›è¡ŒAccessTokenåˆ·æ–°ï¼Œè¿‡æœŸæ—¶é—´ä¸º5åˆ†é’Ÿ(é…ç½®æ–‡ä»¶å¯é…ç½®)ï¼Œæ—¶é—´æˆ³ä¸ºå½“å‰æœ€æ–°æ—¶é—´æˆ³ï¼ŒåŒæ—¶ä¹Ÿè®¾ç½®RefreshTokenä¸­çš„æ—¶é—´æˆ³ä¸ºå½“å‰æœ€æ–°æ—¶
é—´æˆ³ï¼Œåˆ·æ–°è¿‡æœŸæ—¶é—´é‡æ–°ä¸º30åˆ†é’Ÿè¿‡æœŸ(é…ç½®æ–‡ä»¶å¯é…ç½®)ï¼Œæœ€ç»ˆå°†åˆ·æ–°çš„AccessTokenå­˜æ”¾åœ¨Responseçš„Headerä¸­çš„Authorizationå­—æ®µè¿”
å›(å‰ç«¯è¿›è¡Œè·å–æ›¿æ¢ï¼Œä¸‹æ¬¡ç”¨æ–°çš„AccessTokenè¿›è¡Œè®¿é—®)
```

#### è½¯ä»¶æ¶æ„

1. SpringBoot + Mybatisæ ¸å¿ƒæ¡†æ¶
2. PageHelperæ’ä»¶ + é€šç”¨Mapperæ’ä»¶
3. Shiro + Java-JWTæ— çŠ¶æ€é‰´æƒè®¤è¯æœºåˆ¶
4. Redis(Jedis)ç¼“å­˜æ¡†æ¶

#### å®‰è£…æ•™ç¨‹

1. æ•°æ®åº“å¸å·å¯†ç é»˜è®¤ä¸ºrootï¼Œå¦‚æœ‰ä¿®æ”¹ï¼Œè¯·è‡ªè¡Œä¿®æ”¹é…ç½®æ–‡ä»¶application.yml
2. è§£å‹åæ‰§è¡Œsrc\main\resources\sql\MySQL.sqlè„šæœ¬åˆ›å»ºæ•°æ®åº“å’Œè¡¨
3. Rediséœ€è¦è‡ªè¡Œå®‰è£…RedisæœåŠ¡ï¼Œç«¯å£å¯†ç é»˜è®¤
4. SpringBootç›´æ¥å¯åŠ¨å³å¯ï¼Œæµ‹è¯•å·¥å…·PostMan

#### ä½¿ç”¨è¯´æ˜

##### Mybatis Generatorä½¿ç”¨(å¯è§†åŒ–è‡ªå®šä¹‰æ¨¡æ¿å¿«é€Ÿç”ŸæˆåŸºç¡€ä»£ç :[https://github.com/wang926454/ViewGenerator](http://u.720life.cn/g/54145d0471d91890860f7f8463c03046decf31ef85574c244593a43981cee8e94858779d2d608f0857d09f2d634e9422) 

å…ˆé…ç½®src\main\resources\generator\generatorConfig.xmlæ–‡ä»¶(é»˜è®¤é…ç½®éƒ½åœ¨åŸæ¥åŒ…çš„ä¸‹ä¸€çº§reverseåŒ…ä¸‹)ï¼Œåœ¨pom.xmlè¿™ä¸€çº§ç›®å½•(å³é¡¹ç›®æ ¹ç›®å½•ä¸‹)çš„å‘½ä»¤è¡Œçª—å£æ‰§è¡Œ(å‰ææ˜¯é…ç½®äº†mvn)(IDEAå¯ä»¥ç›´æ¥åœ¨Mavençª—å£Pluginsä¸­åŒå‡»æ‰§è¡Œ)
```txt
mvn mybatis-generator:generate
```

##### PostManä½¿ç”¨(Tokenè·å–åŠä½¿ç”¨)

```txt
å…ˆè®¾ç½®Content-Typeä¸ºapplication/json
```
![image text](https://docs.dolyw.com/Project/ShiroJwt/image/20181006001.PNG)
```txt
ç„¶åå¡«å†™è¯·æ±‚å‚æ•°å¸å·å¯†ç ä¿¡æ¯
```
![image text](https://docs.dolyw.com/Project/ShiroJwt/image/20181006002.PNG)
```txt
è¿›è¡Œè¯·æ±‚è®¿é—®ï¼Œè¯·æ±‚è®¿é—®æˆåŠŸ
```
![image text](https://docs.dolyw.com/Project/ShiroJwt/image/20181006003.PNG)
```txt
ç‚¹å‡»æŸ¥çœ‹Headerä¿¡æ¯çš„Authorizationå±æ€§å³æ˜¯Tokenå­—æ®µ
```
![image text](https://docs.dolyw.com/Project/ShiroJwt/image/20181006004.PNG)
```txt
è®¿é—®éœ€è¦æƒé™çš„è¯·æ±‚å°†Tokenå­—æ®µæ”¾åœ¨Headerä¿¡æ¯çš„Authorizationå±æ€§è®¿é—®å³å¯
```
![image text](https://docs.dolyw.com/Project/ShiroJwt/image/20181006005.PNG)
```txt
Tokençš„è‡ªåŠ¨åˆ·æ–°ä¹Ÿæ˜¯åœ¨Tokenå¤±æ•ˆæ—¶è¿”å›æ–°çš„Tokenåœ¨Headerä¿¡æ¯çš„Authorizationå±æ€§
```

#### æ­å»ºå‚è€ƒ

1. æ„Ÿè°¢SmithCruiseçš„Shiro+JWT+Spring Boot Restfulç®€æ˜“æ•™ç¨‹:[https://www.jianshu.com/p/f37f8c295057](http://u.720life.cn/g/8a0e6e781ca1335d5641e0f9d5e96ab925a7bf366d73096a8071f40d7859513f47a24ad115f3044dbf5c426f976a74e6) 
2. æ„Ÿè°¢ç‹æ´ªç‰çš„[Shiroå…¥é—¨]ï¼ˆä¸€ï¼‰ä½¿ç”¨Redisä½œä¸ºç¼“å­˜ç®¡ç†å™¨:[https://blog.csdn.net/why15732625998/article/details/78729254](http://u.720life.cn/g/ce3f6174933242f367d8a4cd3fa79ded5c0ecf3e0463b7bb1113e7acf9000844631143156d65adf82094b9aa57b6f5278ff9230cf7ce6ec81d9d131133e778ad) 
3. æ„Ÿè°¢è¢‹ğŸ´é¥²å…»å‘˜çš„springboot(ä¸ƒ).springbootæ•´åˆjediså®ç°redisç¼“å­˜:[http://www.cnblogs.com/GodHeng/p/9301330.html](http://u.720life.cn/g/94c1d8931f8bedcd3eeaf8cdeb6a662f766ff8102f46c2e4c2fdb622883006bfd1e146d42c84509f0993b833f496b1b5) 
4. æ„Ÿè°¢W_Z_W_888çš„springæ³¨å…¥é™æ€å˜é‡çš„ä¸‰ç§æ–¹æ³•åŠå…¶æ³¨æ„äº‹é¡¹:[https://blog.csdn.net/W_Z_W_888/article/details/79979103](http://u.720life.cn/g/ce3f6174933242f367d8a4cd3fa79ded0ae98598237be8d9e77d2835a2ad4111e283f2a401b9f17c7d4ceecd2d86f5560dc1e747c78d47e6b08bdf1280ad1890) 
5. æ„Ÿè°¢å¤©é™é£äº‘çš„Vue2.0+ElementUI+PageHelperå®ç°çš„è¡¨æ ¼åˆ†é¡µ:[https://blog.csdn.net/u012907049/article/details/70237457](http://u.720life.cn/g/ce3f6174933242f367d8a4cd3fa79ded0f16e451a0354451c19e22947c0523cb0e2acd587150c6f19fb66e93eafc84c06dee5705e9019aa82b7bf4cdfa83dca9) 
6. æ„Ÿè°¢yaxxçš„Vuejsä¹‹axiosè·å–Httpå“åº”å¤´:[https://segmentfault.com/a/1190000009125333](http://u.720life.cn/g/6900aa436d7855810ebad430307e6f91c8b258b81c5d2f9bc5f21dfc6a8e3e4701876d7571884f7eb12ce1d7cdc75141) 
7. æ„Ÿè°¢Twilightçš„è§£å†³ä½¿ç”¨jwtåˆ·æ–°tokenå¸¦æ¥çš„é—®é¢˜:[https://segmentfault.com/a/1190000013151506](http://u.720life.cn/g/6900aa436d7855810ebad430307e6f91c8b258b81c5d2f9bc5f21dfc6a8e3e47f4acd1f4c2345130ad617b92613680f7) 
8. æ„Ÿè°¢chuhxçš„shiroæ‹¦æˆªå™¨ï¼Œè¿”å›jsonæ•°æ®:[https://blog.csdn.net/chuhx/article/details/51148877](http://u.720life.cn/g/ce3f6174933242f367d8a4cd3fa79ded4e84b37b7fe56d0aa5e832bdbcbab38c4f4d1d3c72428ab169440a53d477f38b0d115a4db80dd346355a533510b9f432) 
9. æ„Ÿè°¢yidao620cçš„Shiroè‡ªå¸¦æ‹¦æˆªå™¨é…ç½®è§„åˆ™:[https://github.com/yidao620c/SpringBootBucket/tree/master/springboot-jwt](http://u.720life.cn/g/54145d0471d91890860f7f8463c03046ca0d563cb40b9d80633f0a712da27eb038ac535f24ff26d653813a782ac4681ab34ef84abc1ae088b5fb48f6d29cca7c449e6fa14f3a4fadd4c5baa789858346) 

#### å‚ä¸è´¡çŒ®

1. Fork æœ¬é¡¹ç›®
2. æ–°å»º Feat_xxx åˆ†æ”¯
3. æäº¤ä»£ç 
4. æ–°å»º Pull Request



 # è‰¯å¿ƒå‹æƒ…é“¾æ¥

[è…¾è®¯QQç¾¤å¿«é€Ÿæ£€ç´¢](http://u.720life.cn/s/8cf73f7c)

[è½¯ä»¶å…è´¹å¼€å‘è®ºå›](http://u.720life.cn/s/bbb01dc0)